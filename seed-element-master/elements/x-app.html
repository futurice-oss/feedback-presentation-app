<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/font-roboto/roboto.html">
<link rel="import" href="/bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="/bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="/bower_components/core-menu/core-menu.html">
<link rel="import" href="/bower_components/core-menu/core-submenu.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">

<link rel="import" href="/seed-element-master/elements/x-project-service.html">
<link rel="import" href="/seed-element-master/elements/x-questions-service.html">
<link rel="import" href="/seed-element-master/elements/x-project-answer-list.html">
<link rel="import" href="/seed-element-master/elements/x-questions-list.html">

<polymer-element name="x-app">
  <template>
    <style>
      :host {
        display: block;
      }

      core-scaffold {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        color: #222;
      }

      /* Main view's header bar */
      core-scaffold::shadow core-toolbar {
        background-color: #689f38;
        color: #fff;
      }

      /* Main view's background */
      core-scaffold::shadow [main] {
        background-color: #fafafa;
      }

      /* Menu panel's header bar */
      .panel--menu::shadow #mainPanel, .panel--menu core-toolbar {
        background-color: #fff;
      }

      /* Menu panel */
      .panel--menu {
        background-color: #fff;
      }

      core-scaffold .panel--menu /deep/ core-menu {
        margin: 0;
      }

      paper-item.core-selected {
        background-color: #dcedc8;
      }
      paper-item::shadow #ripple {
        color: #8bc34a;
      }
    </style>

    <core-scaffold>

      <x-project-service id="service" projects="{{ projects }}"></x-project-service>
      <x-questions-service id="qservice" questions="{{ questions }}"></x-questions-service>

      <core-header-panel class="panel--menu" navigation flex mode="waterfall">
        <core-toolbar >Futurice Feedback</core-toolbar>
        <core-menu theme="core-light-theme" selected="0">
        <core-submenu active label="Projects" icon="work" valueattr="name" id="core_submenu">
          <template repeat="{{ p in projects }}">
            <core-item label="{{ p.key }}" on-tap="{{ handleItemTap }}"></core-item>
          </template>
          </core-submenu>
          <core-item icon="star" label="Questions" on-tap="{{ questionsTap }}"></core-item>
        </core-menu>
	</core-header-panel>
  <div tool hidden?="{{ selectedProject == null }}"> {{selectedProject.key}} </div>
  <div tool hidden?="{{ !questionsSelected }}"> Question averages </div>
  <section>
  <header>
  </header>
  <x-project-answer-list hidden?="{{ selectedProject == null }}" project="{{selectedProject}}"></x-project-answer-list>
  <x-question-list hidden?="{{ !questionsSelected }}" questions="{{questions}}"></x-project-answer-list>
	</section>


    </core-scaffold>
  </template>
  <script>
  Polymer('x-app', {
    selectedProject: null,
    questionsSelected: false,
    handleItemTap: function(event, detail, sender) {
      this.selectProject(sender.templateInstance.model.p);
    },
    questionsTap: function(event, detail, sender) {
      this.selectedProject = null;
      this.questionsSelected = true;
	//handle questions tap
    },
    selectProject: function(project) {
      this.selectedProject = project;
      this.questionsSelected = false;
      console.log("Selected tribe: " + project.key);
    },
    ready: function(){
    }
  });
  </script>
</polymer-element>
