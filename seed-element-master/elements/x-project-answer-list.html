<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/seed-element-master/elements/x-individual-project-card.html">
<script type="text/javascript" src="/bower_components/underscore/underscore.js"></script>  

<polymer-element name="x-project-answer-list" attributes="projects availableSpace startIndex searchString">
  <template>
    <style>
      :host {
        display: flex;
      }

    </style>

    <div horizontal flex justify layout>
      <template repeat="{{ p, pIndex in projects }}">
        <template if="{{pIndex >= startIndex && pIndex < (startIndex + availableSpace - cropNCards)}}">
          <x-individual-project-card flex project={{p}} background={{backgrounds[pIndex]}} on-tap={{card_tap}}></x-individual-project-card>
        </template>
      </template>
      <!--div flex style="background-color: {{backgrounds[5]}}" hidden?="{{count != 6}}"></div-->
      </div>
  </template>
  <script>
  Polymer('x-project-answer-list', {
    backgrounds: ['#6bc177', '#67b672', '#64ad6e', '#60a66a', '#5c9d65', '#57905f'],
    selectedCard: null,
    cropNCards: 0,
    card_tap: function(event, detail, sender)
    {
      if(sender == this.selectedCard)
      {
          this.unselect_card(this.selectedCard);
      }
      else
      {
        if(this.selectedCard != null)
          this.unselect_card(this.selectedCard);
        this.selectedCard = sender;
        this.select_card(sender);  
      }
    },
    availableSpaceChanged: function(oldValue, newValue) {
      if(this.selectedCard != null)
        this.unselect_card(this.selectedCard);
    },
    unselect_card: function(card)
    {
      card.removeAttribute('two');
      card.selected = false;
      this.cropNCards = 0;
      this.selectedCard = null;
    },
    select_card: function(card)
    {
      card.setAttribute('two', '');
      card.selected = true;
      this.cropNCards = 1;
    },
    ready: function(){
    }
  });
  </script>
</polymer-element>
